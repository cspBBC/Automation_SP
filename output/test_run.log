
==========================================================================================
Test Execution Started: 2026-02-28 04:15:03
SP Name: usp_CreateUpdateSchedulingTeam
Test Inputs: createSchdGroup
Log File: C:\sp_validation\output\test_run.log
==========================================================================================

Found 1 test case(s) for usp_CreateUpdateSchedulingTeam

================================================================================
[1/1] Case: POSITIVE_CHAIN_CREATE_UPDATE_VALIDATE
Type: POSITIVE
Description: 3-step chain: Create team, update allocations, update miscellaneous
================================================================================

[92m[1m[SUCCESS][0m Chain execution completed successfully!

Chain data (extracted/passed between steps):
  created_team_id: 366

-- POST SQL statements --
SQL: select * from schedulingteams where schedulingteamid = 366
    (366, 'AutoTest_20260228041503', 'Testing_POC', None, 1, 2, 28800, '2', 2, False, 0, False, 0, False, 0, False, False, False, True, False, False, 0, False, 0, False, 0, False, False, False, '', True, False, False, 1, datetime.datetime(1995, 12, 30, 0, 0), 2026, False, True, False, datetime.datetime(2026, 2, 21, 0, 0), 10201, datetime.datetime(2026, 2, 27, 22, 45, 4, 853000), 10201, datetime.datetime(2026, 2, 27, 22, 45, 5, 340000), 0, 0, None, 6, None, 'ankur.jain.ext@bbc.co.uk', 4, 0, None, True, True, True, True, False, False)
SQL: select * from history where userid = 10201 and attributeid = 366 order by historyid desc
    (52422, 3, 10201, 'Record updated by Ankur Jain on 27-02-2026 at 22:45.<br>The Show Handovers changed from "No" to "Yes".<br>', datetime.datetime(2026, 2, 27, 22, 45, 5, 340000), 366, None)
    (52421, 3, 10201, 'Record updated by Ankur Jain on 27-02-2026 at 22:45.<br>The Default Sickness hours for Allocation changed from "7 Hours" to "Standard Day length from teampay config".<br>Record updated by Ankur Jain on 27-02-2026 at 22:45.<br>The Check Over Six Days Worked changed from "No" to "Yes".<br>Record updated by Ankur Jain on 27-02-2026 at 22:45.<br>The Show Production View changed from "No" to "Yes".<br>Record updated by Ankur Jain on 27-02-2026 at 22:45.<br>Create Duty From Rotta Pattern changed from "No" to "Yes".<br>Record updated by Ankur Jain on 27-02-2026 at 22:45.<br>The allow delete duty changed from "No" to "No".<br>', datetime.datetime(2026, 2, 27, 22, 45, 5, 107000), 366, None)
    (52420, 3, 10201, 'Created by Ankur Jain on 27-02-2026 at 22:45.<br>Identity tab record inserted.<br>', datetime.datetime(2026, 2, 27, 22, 45, 4, 853000), 366, None)
SQL: select * from SchedulingGroupsTeamsLinks where schedulingteamid = 366
    -- no rows returned --
-- end POST SQL --


================================================================================
VALIDATING POST-STATE
================================================================================

[Query 1] Validating result set...
  [PASS] Row count: 1 (expected 1)
  [DEBUG] Available columns: ['schedulingTeamId', 'schedulingTeamName', 'schedulingTeamDescription', 'defaultDutyChargeCode', 'isActive']...
  [PASS] schedulingTeamName: AutoTest_20260228041503
  [PASS] schedulingTeamDescription: Testing_POC
  [PASS] isActive: 1

[Query 2] Validating result set...
  [PASS] Row count: 3 (expected 3)

[Query 3] Validating result set...
  [FAIL] Row count: 0 (expected 1)

================================================================================
VALIDATION SUMMARY
================================================================================

  [PASS]  Query 1
  [PASS]  Query 2
  [FAIL]  Query 3

================================================================================
SOME VALIDATIONS FAILED
================================================================================


-- CLEANUP SQL statements --
SQL: DELETE FROM SchedulingGroupsTeamsLinks WHERE schedulingteamid = 366
    -- 0 row(s) affected --
SQL: DELETE FROM Exported_rota WHERE schedulingteamid = 366
    -- 0 row(s) affected --
SQL: DELETE FROM MasterRotas WHERE teamid = 366
    -- 0 row(s) affected --
SQL: DELETE FROM SchedulingTeams WHERE schedulingteamid = 366
    -- 1 row(s) affected --
-- end CLEANUP SQL --


==========================================================================================
TEST SUMMARY
==========================================================================================
  [FAIL]  POSITIVE_CHAIN_CREATE_UPDATE_VALIDATE (POSITIVE)

Total: 1 | Passed: 0 | Failed: 1
==========================================================================================


==========================================================================================

Test Execution Completed: 2026-02-28 04:15:05

==========================================================================================

